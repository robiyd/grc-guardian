{
  "env": "prod",
  "region": "us-west-2",
  "scope": "s3_bucket_security_compliance",
  "steps": [
    {
      "description": "Check S3 buckets for public access",
      "params": {
        "compliance_type": "Config",
        "resource_type": "AWS::S3::Bucket",
        "rule_name": "s3-bucket-public-read-prohibited"
      },
      "tool": "aws_config_eval"
    },
    {
      "description": "Check S3 buckets for public write access",
      "params": {
        "compliance_type": "Config",
        "resource_type": "AWS::S3::Bucket",
        "rule_name": "s3-bucket-public-write-prohibited"
      },
      "tool": "aws_config_eval"
    },
    {
      "description": "Verify S3 bucket encryption",
      "params": {
        "compliance_type": "Config",
        "resource_type": "AWS::S3::Bucket",
        "rule_name": "s3-bucket-server-side-encryption-enabled"
      },
      "tool": "aws_config_eval"
    },
    {
      "description": "Get relevant S3 security best practices",
      "params": {
        "doc_type": "best_practices",
        "max_results": 5,
        "query": "s3 bucket security encryption public access"
      },
      "tool": "rag_retrieve"
    }
  ]
}
